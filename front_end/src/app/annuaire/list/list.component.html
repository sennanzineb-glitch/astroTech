<!-- ================= PAGE HEADER ================= -->
<div class="page-header mb-3">
  <h3 class="page-title">Annuaire</h3>
  <nav aria-label="breadcrumb">
    <ol class="breadcrumb">
      <li class="breadcrumb-item"><a href="#">Annuaire</a></li>
      <li class="breadcrumb-item active">Liste des annuaires</li>
    </ol>
  </nav>
</div>

<!-- ================= AJOUT AFFAIRE ================= -->
<button class="btn btn-gradient-success mb-3" data-bs-toggle="modal" data-bs-target="#saveModal">
  âž• Nouveau client
</button>

<!-- *** Liste des clients *** -->
<div class="row g-3">
  <div class="col-md-6 col-lg-4" *ngFor="let client of clients">
    <div class="card shadow-sm h-100 border-0">

      <div class="card-header d-flex justify-content-between align-items-center bg-light">
        <div>
          <span class="fw-bold">{{ client.nom_client }} - {{ client.numero }}</span>
          <br>
          <small class="text-muted fst-italic">
            Type : <span class="badge bg-secondary">{{ client.type_client | titlecase }}</span>
          </small>
        </div>

        <!-- Groupe des boutons -->
        <div class="btn-group">
          <!-- ðŸ”µ Bouton dÃ©tails -->
          <button class="btn btn-sm btn-outline-info me-1" (click)="viewDetails(client)">
            <i class="fa fa-eye"></i>
          </button>

          <!-- âœ Modifier -->
          <button class="btn btn-sm btn-outline-primary me-1" (click)="editClient(client)">
            <i class="fa fa-edit"></i>
          </button>

          <!-- ðŸ—‘ Supprimer -->
          <button class="btn btn-sm btn-outline-danger" (click)="deleteClient(client.id)">
            <i class="fa fa-trash"></i>
          </button>
        </div>
      </div>

      <div class="card-body">
        <h6 class="card-subtitle mb-2 text-muted">Contacts</h6>

        <div *ngIf="client.contacts?.length > 0; else noContacts">
          <ul class="list-unstyled">
            <li *ngFor="let contact of client.contacts" class="mb-2 p-2 border rounded">
              <strong>{{ contact.nom_complet }}</strong> -
              <em>{{ contact.poste }}</em>

              <!-- Emails -->
              <div class="mt-1">
                <span *ngFor="let email of contact.listEmails" class="badge bg-info text-dark me-1">
                  <i class="fa fa-envelope"></i> {{ email.email }}
                </span>
              </div>

              <!-- TÃ©lÃ©phones -->
              <div class="mt-1">
                <span *ngFor="let tel of contact.listTels" class="badge bg-success me-1">
                  <i class="fa fa-phone"></i> {{ tel.tel }}
                </span>
              </div>

            </li>
          </ul>
        </div>

        <ng-template #noContacts>
          <span class="text-secondary">Aucun contact</span>
        </ng-template>

      </div>
    </div>
  </div>

  <div *ngIf="clients.length === 0" class="col-12">
    <div class="alert alert-secondary text-center mt-3">
      Aucun client trouvÃ©.
    </div>
  </div>
</div>

<!-- *** Modal d'ajout / modification *** -->
<app-modal-save #modalSave (clientAdded)="getAllClients()" (clientUpdated)="getAllClients()">
</app-modal-save>